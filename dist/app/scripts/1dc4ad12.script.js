angular.module("MyApp",["ngResource","ngSanitize","ngAnimate","ngRoute","ui.bootstrap","ngFileUpload","ngCookies"]).config(["$routeProvider","$locationProvider","$httpProvider",function(e){e.when("/",{templateUrl:"public/login.html",controller:"LoginController"}).when("/set_new_password",{templateUrl:"public/setNewPassword.html",controller:"LoginController"}).when("/dashboard",{templateUrl:"public/dashboard.html",controller:"DashboardController"}).when("/products",{templateUrl:"public/products.html",controller:"EntityController"}).when("/customers",{templateUrl:"public/customers.html",controller:"CustomerController"}).when("/users",{templateUrl:"public/users.html",controller:"CustomerController"}).when("/orders",{templateUrl:"public/orderes.html",controller:"OrderController"}).when("/place_order",{templateUrl:"public/place_order.html",controller:"OrderController"}).when("/cart_filling",{templateUrl:"public/cart_filling.html",controller:"OrderController"}).when("/view_order",{templateUrl:"public/view_order.html",controller:"OrderController"}).when("/invoice_generate",{templateUrl:"public/invoice_generate.html",controller:"OrderController"}).when("/invoice",{templateUrl:"public/invoice.html",controller:"OrderController"}).when("/invoice_view",{templateUrl:"public/invoice_view.html",controller:"OrderController"}).when("/payment",{templateUrl:"public/payment.html",controller:"OrderController"}).when("/payment_collection",{templateUrl:"public/payment_collection.html",controller:"OrderController"}).otherwise({redirectTo:""})}]),angular.module("MyApp").controller("CustomerController",["$scope","$http","$route","$location","$window","$timeout","Customer",function(r,e,t,i,o,n,s){r.userRoles=[{title:"Staff",value:"customer"},{title:"Admin",value:"customer_admin"}],r.CustomerDetails=[],r.CustomerTypes=function(){s.CustomerTypes().query().$promise.then(function(e){r.customer_type=e})},r.getUserRole=function(t){var e=r.userRoles.filter(function(e){return e.value==t});return null!=e&&0<e.length?e[0].title:t},r.getCustomerDetails=function(e){r.CustomerDetails.push(e)},r.getCustomerList=function(){s.getCustomerList().query().$promise.then(function(e){e.status||(r.CustomersList=e.customerList)})},r.deleteCustomerDetails=function(t){Swal({title:"Are you sure?",text:"You won't be able to revert this!",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(function(e){e.value&&s.deleteCustomerDetails().query({id:t}).$promise.then(function(e){Swal({type:e.type,title:e.title,text:e.message}).then(function(){r.getCustomerList()})})})},r.VerifyCustomerContacts=function(){r.CustomerDetails[0].email&&""!=r.CustomerDetails[0].email&&null!=r.CustomerDetails[0].email&&s.VerifyCustomerEmail().save(r.CustomerDetails[0]).$promise.then(function(e){0<e.result[0].emailexist?r.emailexist="Email ID already exist in record":r.emailexist=void 0}),r.CustomerDetails[0].mobile&&""!=r.CustomerDetails[0].mobile&&0!=r.CustomerDetails[0].mobile&&null!=r.CustomerDetails[0].mobile&&s.VerifyCustomerMobile().save(r.CustomerDetails[0]).$promise.then(function(e){0<e.result[0].mobileexist?r.mobileexist="Mobile already exist in record":r.mobileexist=void 0})},r.SaveCustomerDetails=function(){s.SaveCustomerDetails().save(r.CustomerDetails[0]).$promise.then(function(e){Swal({type:e.type,title:e.title,text:e.message}).then(function(){r.getCustomerList(),0==e.status&&(r.CustomerDetails=[])})})},r.getUserDetails=function(e){r.UserDetails=[],r.UserDetails.push(e)},r.getUserList=function(){s.getUserList().query().$promise.then(function(e){e.status||(r.UsersList=e.UsersList)})},r.deleteUserDetails=function(t){Swal({title:"Are you sure?",text:"You won't be able to revert this!",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(function(e){e.value&&s.deleteUserDetails().query({id:t}).$promise.then(function(e){Swal({type:e.type,title:e.title,text:e.message}).then(function(){r.getUserList()})})})},r.VerifyUserContacts=function(){r.UserDetails[0].email&&""!=r.UserDetails[0].email&&null!=r.UserDetails[0].email&&s.VerifyUserEmail().save(r.UserDetails[0]).$promise.then(function(e){0<e.result[0].emailexist?r.emailexist="Email ID already exist in record":r.emailexist=void 0}),r.UserDetails[0].mobile&&""!=r.UserDetails[0].mobile&&0!=r.UserDetails[0].mobile&&null!=r.UserDetails[0].mobile&&s.VerifyUserMobile().save(r.UserDetails[0]).$promise.then(function(e){0<e.result[0].mobileexist?r.mobileexist="Mobile already exist in record":r.mobileexist=void 0})},r.SaveUserDetails=function(){s.SaveUserDetails().save(r.UserDetails[0]).$promise.then(function(e){Swal({type:e.type,title:e.title,text:e.message}).then(function(){r.getUserList(),0==e.status&&(r.UserDetails=[],r.getUserList())})})}}]),angular.module("MyApp").controller("DashboardController",["$scope","$http","$route","$location","$window","$timeout","Upload","Dashboard",function(e,t,r,i,o,n,s,a){console.log("Dashboard ctrl works"),e.dataarr=[];for(var l=0;l<30;l++)e.dataarr.push(l);e.SendNotifuication=function(){console.log("-------------------- 1"),a.ExeNotification("sample User","Sample message sent from device")}}]),angular.module("MyApp").controller("EntityController",["$scope","$http","$route","$location","$window","$timeout","Upload","Entity",function(n,e,t,r,i,o,s,a){n.config={itemsPerPage:5,fillLastPage:!0},n.productDetails=[{marathi_name:null}],n.getProductDetails=function(e){n.productDetails=[],n.productDetails.push(e)},n.deleteProductDetails=function(t){Swal({title:"Are you sure?",text:"You won't be able to revert this!",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(function(e){e.value&&a.deleteProductDetails().query({id:t}).$promise.then(function(e){Swal({type:e.type,title:e.title,text:e.message}).then(function(){n.getProductList()})})})},n.getProductList=function(){a.getProductList().query().$promise.then(function(e){e.status||(n.ProductsList=e.productsList)})},n.productTypes=function(){a.productTypes().query().$promise.then(function(e){n.product_type=e})},n.productUnits=function(){a.productUnits().query().$promise.then(function(e){n.productUnit=e})},n.SaveProductDetails=function(){if(n.form.file.$valid&&n.prdImage)var e={file:n.prdImage,productDetails:n.productDetails[0]};else e={productDetails:n.productDetails[0]};s.upload({url:"/api/saveProductDetails",data:e}).then(function(e){Swal({type:e.data.type,title:e.data.title,text:e.data.message}).then(function(){location.reload()})},function(e){Swal({type:e.data.type,title:e.data.title,text:e.data.message}).then(function(){location.reload()})},function(e){parseInt(100*e.loaded/e.total)})},n.resetSelection=function(){angular.element("input[type='file']").val(null),$(".custom-file-input").siblings(".custom-file-label").removeClass("selected").html("Choose file")},n.SelectedFileForUpload=null,n.UploadFile=function(e){n.$apply(function(){n.Message="",n.SelectedFileForUpload=e[0]})},n.ParseExcelDataAndSave=function(){var e=n.SelectedFileForUpload;if(e){var t=new FileReader;t.onload=function(e){var t=e.target.result,r=XLSX.read(t,{type:"binary"}),i=r.SheetNames[0],o=XLSX.utils.sheet_to_row_object_array(r.Sheets[i]);0<o.length?n.ImporProductsDetails(o):n.Message="No data found"},t.onerror=function(e){console.log(e)},t.readAsBinaryString(e)}else n.errormsg="Please select The file first."},n.ImporProductsDetails=function(e){a.ImporProductsDetails().save(e).$promise.then(function(e){Swal({type:e.type,title:e.title,text:e.message}).then(function(){0==e.status||(n.resetSelection(),$("#ModalImportProductsDetails").modal("hide"),n.getProductList())})})},n.MarathiCharSet=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","`",1,2,3,4,5,6,7,8,9,0,"-","=","~","!","@","#","$","%","^","&","*","(",")","_","+","{","}","[","]",";",":",'"',"'","\\",",","<",".",">","/","?"],n.createWordFromLatter=function(e){null==n.productDetails[0].marathi_name&&(n.productDetails[0].marathi_name=""),n.productDetails[0].marathi_name=n.productDetails[0].marathi_name+e}}]),angular.module("MyApp").controller("LoginController",["$scope","$http","$route","$location","$window","$timeout","Upload","Authenticate",function(r,e,t,i,o,n,s,a){function l(e){var t=0;if(!e)return t;for(var r=new Object,i=0;i<e.length;i++)r[e[i]]=(r[e[i]]||0)+1,t+=5/r[e[i]];var o={digits:/\d/.test(e),lower:/[a-z]/.test(e),upper:/[A-Z]/.test(e),nonWords:/\W/.test(e)};for(var n in variationCount=0,o)variationCount+=1==o[n]?1:0;return t+=10*(variationCount-1),parseInt(t)}function u(e){var t=l(e);return 80<t?(r.confirm_password===r.UserDetails[0].password&&$("#resetpassbtn").prop("disabled",!1),"Strong"):60<t?(r.confirm_password===r.UserDetails[0].password&&$("#resetpassbtn").prop("disabled",!1),"Good"):30<=t?"Weak":""}r.fieltype="password",r.AuthenticateUser=function(){a.authUser().save(r.user).$promise.then(function(e){!0===e.success&&(0===e.firstlogin?i.path("/set_new_password"):i.path("/dashboard")),!1===e.success&&(r.errormsg=e.message)},function(e){})},r.changeFieldType=function(){"password"==r.fieltype?(r.fieltype="text",document.getElementById("password-eye").classList.remove("fa-eye"),document.getElementById("password-eye").classList.add("fa-eye-slash")):(r.fieltype="password",document.getElementById("password-eye").classList.remove("fa-eye-slash"),document.getElementById("password-eye").classList.add("fa-eye"))},r.checkcurrpage=function(e){if(null!=e&&0!=e||(e=1),e)r.dispval="",e-1<=0?r.currentPage=0:(r.currentPage=e-1,r.currentPage||(r.currentPage=0));else{window.document.getElementById("mypagevalue").value=r.currentPage+1;var t=window.document.getElementById("mypagevalue");t&&t.focus(),r.currentPage=r.currentPage,r.myValue=null}},r.pagination=function(e){r.recordsdisplay=[{value:10,name:10},{value:25,name:25},{value:50,name:50},{value:100,name:100},{value:e.length,name:"All"}],r.currentPage=0,r.pageSize=10,r.myValue>e.length&&(r.myValue=1),$(".loader").fadeOut("slow"),r.numberOfPages=function(){return Math.ceil(e.length/r.pageSize)}},r.verfiPasswordConf=function(e,t){t&&(t!=e&&(r.passstrenth="Password and confirm password does not match",$("#resetpassbtn").prop("disabled",!0)),t===e&&(r.passstrenth=u(e)))},r.verifyPasswordStrongness=function(e){var t;r.passwordcalc=!(!e||""===e),r.passstrenth=u(e),r.passscore=l(e),r.prgcol=80<(t=l(e))?"green":60<t?"#FFDB00":30<=t?"red":"",r.verfiPasswordConf(e,r.confirm_password)},r.SetNewPassword=function(){a.SetNewPassword().save(r.UserDetails).$promise.then(function(e){1==e.status?Swal({type:e.type,title:e.title,text:e.message}).then(function(){1==e.forgotpassword?i.path("/"):i.path("/dashboard"),r.$apply()}):Swal({type:e.type,title:e.title,text:e.message})})},r.ForgotPassword=function(){a.ForgotPassword().save(r.user).$promise.then(function(e){!0===e.success?(r.sentotpmessage=e.message,n(function(){r.showbtn=!0,n(timer,1e3)},2e4)):Swal({type:e.type,title:e.title,text:e.message}).then(function(){location.reload()})})},r.openNav=!1,r.ToggleNavbar=function(){r.openNav=!0,"main_sidebar animated slideInLeft"==$("#sidenav").attr("class")?($("#sidenav").removeClass("slideInLeft").addClass("slideOutLeft"),$(".container-fluid *").attr("disabled",!1)):($("#sidenav").addClass("slideInLeft").removeClass("slideOutLeft"),$(".container-fluid *").attr("disabled","disabled"))},r.hideNavbar=function(){$("#sidenav").removeClass("slideInLeft").addClass("slideOutLeft"),$(".container-fluid *").attr("disabled",!1)}}]),angular.module("MyApp").controller("OrderController",["$scope","$rootScope","$http","$route","$location","$window","$timeout","Order","Entity","Customer",function(o,e,t,r,i,n,s,a,l,u){function d(e){if(e)var t=new Date(e).getDate(),r=new Date(e).getMonth()+1,i=new Date(e).getFullYear();return i+"/"+r+"/"+t}o.getBackToOrderlist=function(){n.sessionStorage.removeItem("orderid"),n.history.back()},l.getSession().query().$promise.then(function(e){o.userDetails=e}),o.getProductList=function(){l.getProductList().query().$promise.then(function(e){e.status||(o.ProductsList=e.productsList)})},o.productTypes=function(){l.productTypes().query().$promise.then(function(e){o.product_type=e,o.ProductsType=[{title:"All",value:""}],o.product_type.map(function(e){o.ProductsType.push({title:e,value:e})})})},o.productUnits=function(){l.productUnits().query().$promise.then(function(e){o.productUnit=e})},o.validateEntries=function(e){return null!=e.qty&&0<e.qty&&null!=e.unit},o.validateRecentlyUpdated=function(e,t){e!=t&&(e.isRecentlyUpdated=!0)},o.validateCartQty=function(e){e.qty<=e.dil_qty&&(e.isQtySame=!0),e.qty>e.dil_qty&&(e.lowQty=!0)},o.getCustomerList=function(){u.getCustomerList().query().$promise.then(function(e){e.status||(o.CustomersList=e.customerList)})},o.deleteOrder=function(t){Swal({title:"Are you sure?",text:"You won't be able to revert this!",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(function(e){e.value&&a.deleteOrder().query({id:t}).$promise.then(function(e){Swal({type:e.type,title:e.title,text:e.message}).then(function(){o.ListOrders()})})})},o.setCartStatus=function(){o.orderDetails.cartStatus=1},o.setDilivaryStatusofOrder=function(t){Swal({title:"Please confirm details",text:"",html:"<div><table><tr><td>Customer:</td><td>"+t.cust_name+"</td></tr><tr><td>Order Date(Y/M/D):</td><td>"+d(t.orderdate)+"</td></tr><tr><td>Ordered By:</td><td>"+t.ordered_by+"</td></tr></table></div>",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Confirm"}).then(function(e){e.value&&a.confirmToDilivary().query({id:t.id}).$promise.then(function(e){Swal({type:e.type,title:e.title,text:e.message}).then(function(){o.ListOrders()})})})},o.getOrderDetails=function(){o.orderDetails={},a.getOrderDetails().query({orderid:n.sessionStorage.getItem("orderid")}).$promise.then(function(e){e.status||(o.orderdetails=e.orderDetails,o.ProductsList&&0<o.ProductsList.length&&o.ProductsList.map(function(t){o.orderdetails.map(function(e){t.id==e.productid&&(t.qty=e.qty,t.dil_qty=e.dil_qty,t.unit=e.unit,t.orderdetailsid=e.details_id)})}),o.orderDetails.customername=o.orderdetails[0].cust_name,o.orderDetails.orderid=o.orderdetails[0].orderid,o.orderDetails.orderdate=new Date(o.orderdetails[0].orderdate))})},o.getTotal=function(){for(var e=0,t=0;t<o.orderdetails.length;t++){var r=o.orderdetails[t];isNaN(r.netprice)&&(r.netprice=0),e+=r.netprice}return e},o.ListOrders=function(e,t){if(e)var r=e;else r=new Date;if(t)var i=t;else i=r;a.ListOrders().save([{from_orderDate:d(r),to_orderDate:d(i)}]).$promise.then(function(e){e.status||(o.ordersList=e.ordersList)})},o.ListInvoice=function(e,t){if(e)var r=e;else r=new Date;if(t)var i=t;else i=r;a.ListInvoice().save([{fromInvoiceDate:d(r),toInvoiceDate:d(i)}]).$promise.then(function(e){e.status||(o.invoiceList=e.invoiceList)})},o.InitFunctions=function(){o.getProductList(),o.productUnits(),o.productTypes(),o.getCustomerList(),null!=n.sessionStorage.getItem("orderid")&&0<n.sessionStorage.getItem("orderid")&&o.getOrderDetails()},o.setDilQtyAsQty=function(e){e.dil_qty=e.qty,o.validateCartQty(e)},o.saveOrderDetails=function(){if(o.ProductsList)var e=o.ProductsList.filter(function(e){return null!=e.orderdetailsid||null!=e.qty&&null!=e.unit});else if(o.orderdetails)e=o.orderdetails.filter(function(e){return null!=e.dil_qty});0<e.length&&(e[0].customerdetails=o.orderDetails,a.saveOrderDetails().save(e).$promise.then(function(e){Swal({type:e.type,title:e.title,text:e.message}).then(function(){0==e.status||(o.orderDetails={},o.getBackToOrderlist(),o.InitFunctions())})}))},o.generateInvoice=function(){o.orderdetails[0].taxamt=0,o.orderdetails[0].netamt=o.orderdetails[0].totalAmount+o.orderdetails[0].taxamt,a.generateInvoice().save(o.orderdetails).$promise.then(function(e){Swal({type:e.type,title:e.title,text:e.message}).then(function(){0==e.status||(o.orderDetails={},o.getBackToOrderlist(),o.InitFunctions())})})},o.setSessionId=function(e){n.sessionStorage.setItem("orderid",e)},o.RedirectToInvoiceView=function(e,t){o.setSessionId(e),i.path("/"+t)},o.paymentDateils=[],o.getInvoicesOfCustomer=function(e){a.getInvoicesOfCustomer().query({customerid:e.id}).$promise.then(function(e){e.status||(o.CustomerInvoicesList=e.invoiceList)})},o.togglePaymentMethod=function(e){"orderwise"==e?(o.paymentDateils.againestOrder=!0,o.paymentDateils.paidlumpsum=!1):(o.paymentDateils.againestOrder=!1,o.paymentDateils.paidlumpsum=!0)}}]),angular.module("MyApp").factory("Authenticate",["$resource",function(e){return{authUser:function(){return e("/api/authUser",{},{save:{method:"POST",isArray:!1}})},SetNewPassword:function(){return e("/api/SetNewPassword",{},{save:{method:"POST",isArray:!1}})},ForgotPassword:function(){return e("/api/ForgotPassword",{},{save:{method:"POST",isArray:!1}})},getUserDetails:function(){return e("/api/getUserDetails/:userid",{})},checkConnection:function(){return"connected"}}}]),angular.module("MyApp").factory("Customer",["$resource",function(e){return{CustomerTypes:function(){return e("/api/CustomerTypes",{},{query:{method:"GET",isArray:!0}})},getCustomerList:function(){return e("/api/getCustomerList",{},{query:{method:"GET",isArray:!1}})},deleteCustomerDetails:function(){return e("/api/deleteCustomerDetails/:id",{},{query:{method:"GET",isArray:!1}})},SaveCustomerDetails:function(){return e("/api/SaveCustomerDetails",{},{save:{method:"POST",isArray:!1}})},VerifyCustomerEmail:function(){return e("/api/VerifyCustomerEmail",{},{save:{method:"POST",isArray:!1}})},VerifyCustomerMobile:function(){return e("/api/VerifyCustomerMobile",{},{save:{method:"POST",isArray:!1}})},getUserList:function(){return e("/api/getUserList",{},{query:{method:"GET",isArray:!1}})},deleteUserDetails:function(){return e("/api/deleteUserDetails/:id",{},{query:{method:"GET",isArray:!1}})},SaveUserDetails:function(){return e("/api/SaveUserDetails",{},{save:{method:"POST",isArray:!1}})},VerifyUserEmail:function(){return e("/api/VerifyUserEmail",{},{save:{method:"POST",isArray:!1}})},VerifyUserMobile:function(){return e("/api/VerifyUserMobile",{},{save:{method:"POST",isArray:!1}})}}}]),angular.module("MyApp").factory("Dashboard",["$resource",function(e){return{ExeNotification:function(t,r){if("Notification"in window)if("granted"===Notification.permission)new Notification(t+" Posted a comment",{body:r,dir:"ltr",icon:"../../../favicon.ico"});else"denied"!==Notification.permission&&Notification.requestPermission(function(e){if("permission"in Notification||(Notification.permission=e),"granted"===e)new Notification(t+" Posted a comment",{body:r,dir:"ltr"})});else alert("This browser does not support desktop notification")}}}]),angular.module("MyApp").factory("Entity",["$resource","Upload",function(e,t){return{ImporProductsDetails:function(){return e("/api/ImporProductsDetails",{},{save:{method:"POST",isArray:!1}})},getSession:function(){return e("/api/getSession",{},{query:{method:"GET",isArray:!1}})},getProductList:function(){return e("/api/getProductList",{},{query:{method:"GET",isArray:!1}})},productTypes:function(){return e("/api/productTypes",{},{query:{method:"GET",isArray:!0}})},productUnits:function(){return e("/api/productUnits",{},{query:{method:"GET",isArray:!0}})},deleteProductDetails:function(){return e("/api/deleteProductDetails/:id",{},{query:{method:"GET",isArray:!1}})}}}]),angular.module("MyApp").factory("Order",["$resource",function(e){return{saveOrderDetails:function(){return e("/api/saveOrderDetails",{},{save:{method:"POST",isArray:!1}})},generateInvoice:function(){return e("/api/generateInvoice",{},{save:{method:"POST",isArray:!1}})},ListOrders:function(){return e("/api/ListOrders",{},{save:{method:"POST",isArray:!1}})},ListInvoice:function(){return e("/api/ListInvoice",{},{save:{method:"POST",isArray:!1}})},getOrderDetails:function(){return e("/api/getOrderDetails/:orderid",{},{query:{method:"GET",isArray:!1}})},getInvoicesOfCustomer:function(){return e("/api/getInvoicesOfCustomer/:customerid",{},{query:{method:"GET",isArray:!1}})},deleteOrder:function(){return e("/api/deleteOrder/:id",{},{query:{method:"GET",isArray:!1}})},confirmToDilivary:function(){return e("/api/confirmToDilivary/:id",{},{query:{method:"GET",isArray:!1}})}}}]),angular.module("MyApp").directive("section",function(){return{restrict:"C",controller:"LoginController",link:function(e,t,r){t.bind("click",function(){e.$apply(function(){$(t).is("div.section")&&e.hideNavbar()})})}}}).directive("fileModel",["$parse",function(o){return{restrict:"A",link:function(e,t,r){var i=o(r.fileModel).assign;t.bind("change",function(){e.$apply(function(){i(e,t[0].files[0])})})}}}]).filter("startFrom",function(){return function(e,t){return e?(t=+t,e.slice(t)):[]}});